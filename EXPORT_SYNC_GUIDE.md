# 导出和同步功能使用指南

## 📤 导出功能

### 支持的格式

应用支持将笔记导出为以下格式：

1. **PDF** - 适合打印和分享
2. **Word (.docx)** - 可在Microsoft Word中继续编辑
3. **Markdown (.md)** - 适合在其他Markdown编辑器中使用
4. **HTML** - 可在浏览器中查看

### 如何导出

#### 方法一：使用菜单

1. 在笔记列表中选择要导出的笔记
2. 点击菜单栏"文件" → "导出"
3. 选择导出格式
4. 导出完成后会提示是否打开文件

#### 方法二：使用快捷键

| 格式 | 快捷键 |
|------|--------|
| PDF | `Ctrl+Shift+P` |
| Word | `Ctrl+Shift+W` |
| Markdown | `Ctrl+Shift+M` |

### 导出位置

所有导出的文件默认保存在：
```
~/Documents/MathNotes导出/
```

文件命名格式：`笔记标题_时间戳.扩展名`

例如：`二次方程_20260104_183000.pdf`

### 打开导出文件夹

点击菜单栏"文件" → "导出" → "打开导出文件夹"，可以快速打开导出目录。

### 导出注意事项

#### PDF导出
- ✅ 无需额外依赖
- ✅ 保留所有格式
- ✅ 支持数学公式
- ⚠️ 文件较大

#### Word导出
- ⚠️ 需要安装额外库：`pip install python-docx beautifulsoup4`
- ✅ 可继续编辑
- ⚠️ 数学公式可能显示为文本
- ✅ 文件较小

#### Markdown导出
- ⚠️ 需要安装额外库：`pip install html2text beautifulsoup4`
- ✅ 纯文本格式
- ⚠️ 数学公式转换为LaTeX代码
- ✅ 文件最小
- ✅ 跨平台兼容性好

#### HTML导出
- ✅ 无需额外依赖
- ✅ 保留所有格式
- ✅ 可在浏览器中查看
- ✅ 文件较小

### 批量导出

目前版本暂不支持批量导出，需要逐个导出笔记。未来版本会添加批量导出功能。

---

## ☁️ iCloud同步功能

### 功能概述

iCloud同步功能允许你在多台Mac设备之间自动同步笔记，无需手动备份和传输。

### 工作原理

- 使用iCloud Drive作为同步存储
- 不使用iCloud云盘，而是使用系统级别的iCloud Drive API
- 自动检测冲突并智能合并
- 保留较新版本的笔记

### 启用同步

#### 前提条件

1. ✅ 已在系统设置中登录iCloud账户
2. ✅ 已启用iCloud Drive
3. ✅ 有足够的iCloud存储空间（笔记通常很小，几MB即可）

#### 启用步骤

1. 打开应用
2. 点击菜单栏"同步" → "启用iCloud同步"
3. 系统会检查iCloud可用性
4. 启用成功后，会显示确认消息

### 同步操作

#### 1. 立即同步（上传）

**作用**：将本地笔记上传到iCloud

**操作方法**：
- 点击菜单栏"同步" → "立即同步"
- 或使用快捷键 `Ctrl+S`

**适用场景**：
- 刚创建或修改了重要笔记
- 准备在另一台设备上使用
- 手动触发同步

#### 2. 从iCloud拉取（下载）

**作用**：从iCloud下载笔记并合并到本地

**操作方法**：
- 点击菜单栏"同步" → "从iCloud拉取"

**适用场景**：
- 在新设备上首次使用
- 想获取其他设备上的最新笔记
- 本地数据丢失需要恢复

**注意**：拉取操作会智能合并笔记，不会直接覆盖本地数据。

#### 3. 自动同步

**作用**：应用会自动在后台同步笔记

**触发时机**：
- 每5分钟自动同步一次
- 关闭应用时自动同步
- 需要先启用iCloud同步

**优点**：
- 无需手动操作
- 始终保持最新状态
- 防止数据丢失

### 冲突处理

当本地和iCloud上都有同一笔记的不同版本时：

1. **自动合并**：系统会比较两个版本的更新时间
2. **保留较新版本**：自动选择最近修改的版本
3. **不会丢失数据**：旧版本不会被删除，只是不显示

### 查看同步状态

点击菜单栏"同步" → "同步状态"，可以查看：

- iCloud同步是否启用
- iCloud是否可用
- 上次同步时间

### 同步数据位置

#### 本地数据
```
~/.mathnotes/
├── notes.json          # 笔记数据
└── sync_config.json    # 同步配置
```

#### iCloud数据
```
~/Library/Mobile Documents/com~apple~CloudDocs/MathNotes/
└── notes_sync.json     # 同步的笔记数据
```

### 多设备同步

#### 场景：在两台Mac之间同步

**设备A（办公室Mac）**：
1. 启用iCloud同步
2. 创建或编辑笔记
3. 点击"立即同步"或等待自动同步

**设备B（家里Mac）**：
1. 安装应用
2. 启用iCloud同步
3. 点击"从iCloud拉取"
4. 笔记会自动出现在列表中

**后续使用**：
- 两台设备都会自动同步
- 在任一设备上的修改会同步到另一台
- 无需手动操作

### 常见问题

#### Q: 同步失败怎么办？

**检查清单**：
1. ✅ 确认已登录iCloud账户
2. ✅ 确认iCloud Drive已启用
3. ✅ 确认网络连接正常
4. ✅ 确认有足够的iCloud存储空间
5. ✅ 尝试重启应用

#### Q: 同步会消耗多少iCloud空间？

- 每条笔记通常只有几KB
- 100条笔记大约1-2MB
- 即使是免费的5GB iCloud空间也足够使用

#### Q: 同步安全吗？

- ✅ 使用Apple的iCloud Drive，安全可靠
- ✅ 数据传输加密
- ✅ 只有你的iCloud账户可以访问
- ✅ 不会上传到第三方服务器

#### Q: 可以禁用同步吗？

可以。点击菜单栏"同步" → "启用iCloud同步"（取消勾选）即可禁用。

禁用后：
- 不会再自动同步
- 本地数据不受影响
- iCloud上的数据会保留
- 可以随时重新启用

#### Q: 同步会影响性能吗？

- ❌ 不会影响编辑性能
- ❌ 同步在后台进行
- ❌ 不会阻塞界面操作
- ✅ 几乎感觉不到

#### Q: 支持iPhone/iPad同步吗？

目前版本仅支持Mac设备之间同步。未来可能会开发iOS版本。

### 最佳实践

1. **定期检查同步状态**
   - 每周查看一次同步状态
   - 确保同步正常工作

2. **重要笔记手动同步**
   - 创建重要笔记后立即手动同步
   - 不要完全依赖自动同步

3. **定期备份**
   - 虽然有iCloud同步，但建议定期导出备份
   - 可以导出为PDF或Markdown格式

4. **多设备使用**
   - 在每台设备上都启用同步
   - 避免在多台设备上同时编辑同一笔记

5. **网络环境**
   - 在稳定的WiFi环境下同步
   - 避免在移动网络下大量同步

---

## 🎯 使用技巧

### 导出技巧

1. **选择合适的格式**
   - 打印/分享 → PDF
   - 继续编辑 → Word
   - 跨平台 → Markdown
   - 网页查看 → HTML

2. **文件命名**
   - 导出前给笔记起一个清晰的标题
   - 标题会作为文件名的一部分

3. **批量处理**
   - 虽然不支持批量导出，但可以使用脚本
   - 或者等待未来版本的批量导出功能

### 同步技巧

1. **首次使用**
   - 在主设备上先创建一些笔记
   - 然后在其他设备上拉取

2. **避免冲突**
   - 尽量不要在多台设备上同时编辑
   - 编辑前先拉取最新版本

3. **定期清理**
   - 定期删除不需要的笔记
   - 减少同步数据量

4. **监控空间**
   - 定期检查iCloud存储空间
   - 及时清理不需要的数据

---

**享受无缝的笔记体验！** 📝✨
