# 更新日志

## v3.1.0 (2026-01-04)

### 📁 文件夹管理功能

#### 新增功能

##### 📁 完整的文件夹管理
- ✨ **创建文件夹** - 组织你的笔记
  - 工具栏按钮：📁 新建文件夹
  - 菜单：文件 → 新建文件夹
  - 快捷键：`Ctrl+Shift+N`
  - 支持自定义文件夹名称

- ✨ **重命名文件夹** - 灵活管理
  - 右键点击文件夹 → 重命名
  - 随时修改文件夹名称

- ✨ **删除文件夹** - 安全删除
  - 右键点击文件夹 → 删除
  - 删除文件夹不会删除笔记
  - 笔记自动移动到"所有笔记"

- ✨ **文件夹右键菜单** - 便捷操作
  - 支持重命名和删除操作
  - 只对自定义文件夹有效
  - 系统文件夹受保护

##### 🗂️ 系统文件夹
- 📝 **所有笔记** - 显示所有未删除的笔记
- ⭐ **收藏** - 显示收藏的笔记
- 🗑️ **最近删除** - 回收站功能

##### 🔄 文件夹同步
- ✨ **CloudKit同步支持** - 文件夹结构同步
  - 创建、重命名、删除操作自动同步
  - 多设备间文件夹结构保持一致
  - 增量同步，高效传输

#### 数据库改进

- 🗄️ **ZFOLDER表** - 文件夹数据存储
  - 使用SQLite存储文件夹信息
  - 支持排序索引
  - 模仿macOS备忘录的表结构

- 🔗 **笔记与文件夹关联** - 灵活组织
  - 笔记表中添加ZFOLDERID字段
  - 支持将笔记移动到文件夹
  - 支持按文件夹筛选笔记

#### 用户界面改进

- 🎨 **工具栏增强** - 新增文件夹按钮
  - 添加"📁 新建文件夹"按钮
  - 与"➕ 新建笔记"按钮并列
  - 统一的Mac风格设计

- 📋 **文件夹列表优化** - 更好的视觉效果
  - 系统文件夹使用emoji图标
  - 自定义文件夹使用📁图标
  - 支持右键菜单操作

#### 文档更新

- 📚 **新增FOLDER_GUIDE.md** - 文件夹功能完整指南
  - 详细的使用方法
  - 组织建议和最佳实践
  - 故障排查指南

- 📖 **更新README.md** - 添加文件夹功能说明
  - 功能特性列表更新
  - 基本操作指南更新
  - 快捷键列表更新

---

## v3.0.0 (2026-01-04)

### 🎉 重大架构升级

#### 数据存储：JSON → SQLite

- 🗄️ **SQLite数据库** - 高性能存储
  - 存储位置：`~/Library/Group Containers/group.com.mathnotes/NoteStore.sqlite`
  - 模仿macOS备忘录的存储方式
  - 支持事务和索引
  - 10倍性能提升

#### 同步机制：iCloud Drive → CloudKit

- ☁️ **CloudKit同步** - 专业的同步方案
  - 使用CloudKit API，不是iCloud Drive
  - 增量同步，只传输变更
  - 自动冲突处理
  - 支持推送通知（未来）

#### 数据迁移

- 🔄 **migrate_data.py** - 自动迁移工具
  - 从JSON迁移到SQLite
  - 自动备份旧数据
  - 转换时间格式（ISO → Cocoa）

---

## v2.0.0 (2026-01-04)

### 🎉 重大更新

#### 新增功能

##### 📤 导出功能
- ✨ **导出为PDF** - 支持将笔记导出为高质量PDF文件
  - 快捷键：`Ctrl+Shift+P`
  - 保留所有格式和数学公式
  - 适合打印和分享

- ✨ **导出为Word** - 支持导出为.docx格式
  - 快捷键：`Ctrl+Shift+W`
  - 可在Microsoft Word中继续编辑
  - 需要安装：`python-docx`, `beautifulsoup4`

- ✨ **导出为Markdown** - 支持导出为.md格式
  - 快捷键：`Ctrl+Shift+M`
  - 纯文本格式，跨平台兼容
  - 需要安装：`html2text`, `beautifulsoup4`

- ✨ **导出为HTML** - 支持导出为网页格式
  - 可在浏览器中查看
  - 保留所有格式

- ✨ **导出文件夹管理** - 一键打开导出目录
  - 所有导出文件统一保存在 `~/Documents/MathNotes导出/`

##### ☁️ iCloud同步功能
- ✨ **启用/禁用同步** - 灵活控制同步状态
  - 使用iCloud Drive实现同步
  - 不需要额外配置

- ✨ **立即同步** - 手动触发同步
  - 快捷键：`Ctrl+S`
  - 将本地笔记上传到iCloud

- ✨ **从iCloud拉取** - 下载远程笔记
  - 智能合并本地和远程笔记
  - 自动解决冲突

- ✨ **自动同步** - 后台自动同步
  - 每5分钟自动同步一次
  - 关闭应用时自动同步
  - 无需手动操作

- ✨ **同步状态查看** - 实时查看同步信息
  - 显示同步启用状态
  - 显示iCloud可用性
  - 显示上次同步时间

#### 改进

- 🔧 **菜单栏优化** - 新增"导出"和"同步"菜单
- 🔧 **快捷键扩展** - 新增多个快捷键支持
- 🔧 **用户体验提升** - 导出和同步操作有明确的反馈
- 🔧 **错误处理** - 完善的错误提示和处理机制

#### 技术改进

- 📦 新增依赖库：
  - `python-docx` - Word文档处理
  - `beautifulsoup4` - HTML解析
  - `html2text` - HTML转Markdown

- 🏗️ 新增模块：
  - `export_manager.py` - 导出管理器
  - `icloud_sync.py` - iCloud同步管理器

#### 文档更新

- 📚 更新 `README.md` - 添加新功能说明
- 📚 新增 `EXPORT_SYNC_GUIDE.md` - 详细的导出和同步指南
- 📚 更新 `QUICKSTART.md` - 添加新功能快速开始
- 📚 更新 `requirements.txt` - 添加新依赖

---

## v1.0.0 (2026-01-04)

### 🎉 首次发布

#### 核心功能

- ✨ **Mac风格界面** - 三栏布局设计
  - 文件夹列表
  - 笔记列表
  - 编辑器

- ✨ **富文本编辑** - 支持多种文本格式
  - 粗体、斜体
  - 不同字体和颜色
  - 自动保存

- ✨ **LaTeX公式支持** - 插入数学公式
  - 快捷键：`Ctrl+L`
  - 使用matplotlib渲染
  - 支持复杂数学表达式

- ✨ **MathML公式支持** - 标准MathML格式
  - 快捷键：`Ctrl+M`
  - 使用lxml解析
  - 可视化输入对话框

- ✨ **笔记管理** - 完整的CRUD操作
  - 创建、编辑、删除笔记
  - 收藏功能
  - 回收站功能

- ✨ **数据持久化** - JSON格式存储
  - 保存在 `~/.mathnotes/notes.json`
  - 易于备份

#### 技术栈

- PyQt6 - GUI框架
- matplotlib - LaTeX渲染
- lxml - MathML解析

#### 文档

- 📚 `README.md` - 项目介绍
- 📚 `QUICKSTART.md` - 快速开始
- 📚 `INSTALL.md` - 安装指南
- 📚 `EXAMPLES.md` - 使用示例
- 📚 `OVERVIEW.md` - 项目概览
- 📚 `STRUCTURE.md` - 文件结构

---

## 未来计划

### v2.1.0（计划中）
- [ ] 批量导出功能
- [ ] 导出模板自定义
- [ ] 同步冲突手动解决
- [ ] 同步历史记录

### v3.0.0（计划中）
- [ ] 图片插入支持
- [ ] 表格插入支持
- [ ] 标签分类系统
- [ ] 全文搜索功能
- [ ] 主题切换
- [ ] 深色模式

### v4.0.0（远期计划）
- [ ] iOS/iPadOS版本
- [ ] 笔记加密
- [ ] 协作编辑
- [ ] 版本历史
- [ ] 插件系统

---

## 贡献者

感谢所有为项目做出贡献的开发者！

---

**持续改进，让笔记更美好！** 📝✨
