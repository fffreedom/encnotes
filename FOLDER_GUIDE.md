# 文件夹功能使用指南

## 📁 概述

数学笔记应用支持完整的文件夹管理功能，帮助你更好地组织笔记。

---

## ✨ 功能特性

### 系统文件夹

应用自带三个系统文件夹，无法删除或重命名：

1. **📝 所有笔记** - 显示所有未删除的笔记
2. **⭐ 收藏** - 显示所有收藏的笔记
3. **🗑️ 最近删除** - 显示已删除的笔记（可恢复或永久删除）

### 自定义文件夹

你可以创建任意数量的自定义文件夹来组织笔记。

---

## 🚀 使用方法

### 1. 创建文件夹

#### 方法一：使用工具栏

1. 点击工具栏中的 **📁 新建文件夹** 按钮
2. 输入文件夹名称
3. 点击"确定"

#### 方法二：使用菜单

1. 点击菜单栏 **文件** → **新建文件夹**
2. 输入文件夹名称
3. 点击"确定"

#### 方法三：使用快捷键

- 按 **Ctrl+Shift+N**
- 输入文件夹名称
- 点击"确定"

### 2. 重命名文件夹

1. 在文件夹列表中，**右键点击**要重命名的文件夹
2. 选择 **重命名**
3. 输入新名称
4. 点击"确定"

### 3. 删除文件夹

1. 在文件夹列表中，**右键点击**要删除的文件夹
2. 选择 **删除**
3. 确认删除

**注意**：
- 删除文件夹不会删除其中的笔记
- 文件夹中的笔记会自动移动到"所有笔记"

### 4. 将笔记移动到文件夹

#### 创建笔记时指定文件夹

1. 选中目标文件夹
2. 点击 **➕ 新建笔记** 或按 **Ctrl+N**
3. 新笔记会自动创建在当前选中的文件夹中

#### 移动现有笔记

1. 在笔记列表中选中要移动的笔记
2. 右键点击笔记
3. 选择 **移动到文件夹**
4. 选择目标文件夹

### 5. 查看文件夹中的笔记

1. 在文件夹列表中点击文件夹
2. 右侧笔记列表会显示该文件夹中的所有笔记

---

## 💡 使用技巧

### 文件夹组织建议

#### 按学科分类
```
📁 高等数学
📁 线性代数
📁 概率论
📁 离散数学
```

#### 按主题分类
```
📁 微积分
📁 方程求解
📁 几何证明
📁 统计分析
```

#### 按项目分类
```
📁 期末复习
📁 作业笔记
📁 考试重点
📁 课外学习
```

#### 按时间分类
```
📁 2026年春季
📁 2026年秋季
📁 暑期学习
```

### 快捷键汇总

| 功能 | 快捷键 |
|------|--------|
| 新建笔记 | Ctrl+N |
| 新建文件夹 | Ctrl+Shift+N |
| 删除笔记 | Ctrl+D |

---

## 🗄️ 数据库结构

### 文件夹表（ZFOLDER）

文件夹数据存储在 SQLite 数据库中：

```sql
CREATE TABLE ZFOLDER (
    Z_PK INTEGER PRIMARY KEY,
    ZIDENTIFIER TEXT UNIQUE,      -- UUID
    ZNAME TEXT NOT NULL,           -- 文件夹名称
    ZCREATIONDATE REAL,            -- 创建时间
    ZMODIFICATIONDATE REAL,        -- 修改时间
    ZORDERINDEX INTEGER            -- 排序索引
);
```

### 笔记与文件夹关联

笔记表中的 `ZFOLDERID` 字段关联到文件夹：

```sql
-- 笔记表中的文件夹字段
ZFOLDERID TEXT,  -- 文件夹ID（外键）
```

---

## 🔄 同步支持

### CloudKit 同步

文件夹支持 CloudKit 同步：

- ✅ 创建的文件夹会自动同步到 iCloud
- ✅ 重命名和删除操作也会同步
- ✅ 多设备间文件夹结构保持一致

### 同步机制

1. **增量同步** - 只同步变更的文件夹
2. **自动冲突处理** - 使用时间戳自动解决冲突
3. **实时更新** - 其他设备的变更会自动拉取

---

## 📊 示例场景

### 场景1：整理数学笔记

```
1. 创建文件夹"微积分基础"
2. 创建文件夹"微积分应用"
3. 将相关笔记移动到对应文件夹
4. 收藏重要笔记
```

### 场景2：准备考试

```
1. 创建文件夹"期末复习"
2. 在该文件夹中创建各章节笔记
3. 标记重点笔记为收藏
4. 导出为PDF用于打印
```

### 场景3：项目管理

```
1. 为每个项目创建文件夹
2. 在文件夹中记录项目进展
3. 使用LaTeX记录数学公式
4. 定期同步到iCloud
```

---

## ⚠️ 注意事项

### 文件夹限制

1. **系统文件夹不可修改**
   - "所有笔记"、"收藏"、"最近删除"是系统文件夹
   - 无法重命名或删除

2. **文件夹名称要求**
   - 不能为空
   - 建议使用有意义的名称
   - 支持中英文和特殊字符

3. **删除文件夹**
   - 删除文件夹不会删除笔记
   - 笔记会移动到"所有笔记"
   - 操作不可撤销

### 性能建议

1. **合理组织**
   - 建议创建 5-20 个文件夹
   - 避免创建过多空文件夹

2. **定期整理**
   - 定期清理不需要的文件夹
   - 合并相似主题的文件夹

---

## 🔧 故障排查

### 问题1：文件夹不显示

**可能原因**：
- 数据库连接问题
- 文件夹数据损坏

**解决方法**：
1. 重启应用
2. 检查数据库文件是否存在
3. 运行数据迁移工具

### 问题2：无法创建文件夹

**可能原因**：
- 数据库权限问题
- 磁盘空间不足

**解决方法**：
1. 检查磁盘空间
2. 检查文件权限
3. 查看错误日志

### 问题3：文件夹同步失败

**可能原因**：
- iCloud 未登录
- 网络连接问题
- CloudKit 配额限制

**解决方法**：
1. 检查 iCloud 登录状态
2. 检查网络连接
3. 手动触发同步

---

## 📚 相关文档

- [README.md](README.md) - 应用总览
- [ARCHITECTURE.md](ARCHITECTURE.md) - 技术架构
- [EXPORT_SYNC_GUIDE.md](EXPORT_SYNC_GUIDE.md) - 导出和同步指南
- [QUICKSTART.md](QUICKSTART.md) - 快速开始

---

## 🎉 总结

文件夹功能让你可以：

✅ **更好地组织笔记** - 按学科、主题、项目分类  
✅ **快速查找笔记** - 在特定文件夹中搜索  
✅ **灵活管理** - 创建、重命名、删除文件夹  
✅ **多设备同步** - 文件夹结构在所有设备间同步  
✅ **简单易用** - 直观的界面和快捷键  

开始使用文件夹功能，让你的笔记管理更高效！📁✨
